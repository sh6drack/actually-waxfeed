From d95693440d5defbd6528ba38c520e3dfeb258ed5 Mon Sep 17 00:00:00 2001
From: sh6drack <sh6drack@users.noreply.github.com>
Date: Sun, 25 Jan 2026 20:48:42 -0500
Subject: [PATCH 39/50] feat: comprehensive 4-step onboarding with built-in
 Quick Rate

- Step 1: Username claim
- Step 2: Profile photo upload
- Step 3: Country selection for personalization
- Step 4: 20 Quick Rates to train TasteID

Added countries data file with 50+ countries for region selection.
Updated swipe API with onboarding mode for popular albums.
Updated users API to support country field.

Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>
---
 src/app/api/albums/swipe/route.ts |  48 +++-
 src/app/api/users/route.ts        |   4 +-
 src/app/onboarding/page.tsx       | 435 ++++++++++++++++++++++++++++--
 src/data/countries.ts             |  69 +++++
 4 files changed, 531 insertions(+), 25 deletions(-)
 create mode 100644 src/data/countries.ts

diff --git a/src/app/api/albums/swipe/route.ts b/src/app/api/albums/swipe/route.ts
index 56769c5..a54a5b9 100644
--- a/src/app/api/albums/swipe/route.ts
+++ b/src/app/api/albums/swipe/route.ts
@@ -8,6 +8,47 @@ export async function GET(request: NextRequest) {
     const user = await requireAuth()
     const { searchParams } = new URL(request.url)
     const limit = Math.min(parseInt(searchParams.get('limit') || '20'), 50)
+    const isOnboarding = searchParams.get('onboarding') === 'true'
+
+    // Get IDs of albums the user has already reviewed
+    const reviewedAlbumIds = await prisma.review.findMany({
+      where: { userId: user.id },
+      select: { albumId: true },
+    })
+    const reviewedIds = reviewedAlbumIds.map(r => r.albumId)
+
+    // For onboarding, return popular/well-reviewed albums for broader appeal
+    if (isOnboarding) {
+      const popularAlbums = await prisma.album.findMany({
+        where: {
+          id: { notIn: reviewedIds },
+          coverArtUrl: { not: null },
+          totalReviews: { gte: 3 },
+          averageRating: { gte: 6 },
+        },
+        select: {
+          id: true,
+          title: true,
+          artistName: true,
+          coverArtUrl: true,
+          coverArtUrlLarge: true,
+          releaseDate: true,
+          genres: true,
+        },
+        take: limit * 2, // Get extra for shuffling
+        orderBy: [
+          { totalReviews: 'desc' },
+          { averageRating: 'desc' },
+        ],
+      })
+
+      // Shuffle and return
+      const shuffled = popularAlbums
+        .sort(() => Math.random() - 0.5)
+        .slice(0, limit)
+
+      return successResponse(shuffled)
+    }
 
     // Get user's TasteID for personalization
     const tasteId = await prisma.tasteID.findUnique({
@@ -20,13 +61,6 @@ export async function GET(request: NextRequest) {
       },
     })
 
-    // Get IDs of albums the user has already reviewed
-    const reviewedAlbumIds = await prisma.review.findMany({
-      where: { userId: user.id },
-      select: { albumId: true },
-    })
-    const reviewedIds = reviewedAlbumIds.map(r => r.albumId)
-
     // Get user's highly-rated albums for artist inference
     const likedReviews = await prisma.review.findMany({
       where: {
diff --git a/src/app/api/users/route.ts b/src/app/api/users/route.ts
index dcbfc0d..3862f12 100644
--- a/src/app/api/users/route.ts
+++ b/src/app/api/users/route.ts
@@ -6,6 +6,7 @@ import { z } from 'zod'
 const updateUserSchema = z.object({
   username: z.string().min(3).max(30).regex(/^[a-zA-Z0-9_]+$/, 'Username can only contain letters, numbers, and underscores').optional(),
   bio: z.string().max(150).optional(),
+  country: z.string().length(2).optional(), // ISO 3166-1 alpha-2 code
   socialLinks: z.object({
     instagram: z.string().optional(),
     twitter: z.string().optional(),
@@ -63,7 +64,7 @@ export async function PATCH(request: NextRequest) {
       return errorResponse(validation.error.errors[0].message, 400)
     }
 
-    const { username, bio, socialLinks, image } = validation.data
+    const { username, bio, country, socialLinks, image } = validation.data
 
     // Handle username change
     if (username) {
@@ -96,6 +97,7 @@ export async function PATCH(request: NextRequest) {
       data: {
         username,
         bio,
+        country,
         socialLinks: socialLinks as object,
         image,
         usernameChangesUsed: username ? { increment: 1 } : undefined,
diff --git a/src/app/onboarding/page.tsx b/src/app/onboarding/page.tsx
index d06c1f2..21847b6 100644
--- a/src/app/onboarding/page.tsx
+++ b/src/app/onboarding/page.tsx
@@ -2,8 +2,22 @@
 
 import { useSession } from "next-auth/react"
 import { useRouter } from "next/navigation"
-import { useState, useEffect, useRef } from "react"
+import { useState, useEffect, useRef, useCallback } from "react"
 import { DefaultAvatar } from "@/components/default-avatar"
+import { RatingSlider } from "@/components/rating-slider"
+import { COUNTRIES } from "@/data/countries"
+
+const TOTAL_STEPS = 4
+const REQUIRED_RATINGS = 20
+
+interface Album {
+  id: string
+  title: string
+  artistName: string
+  coverArtUrl: string | null
+  coverArtUrlLarge: string | null
+  genres: string[]
+}
 
 export default function OnboardingPage() {
   const { data: session, status, update } = useSession()
@@ -13,11 +27,22 @@ export default function OnboardingPage() {
   const [step, setStep] = useState(1)
   const [username, setUsername] = useState("")
   const [image, setImage] = useState<string | null>(null)
+  const [country, setCountry] = useState("")
+  const [countrySearch, setCountrySearch] = useState("")
   const [error, setError] = useState("")
   const [loading, setLoading] = useState(false)
   const [checking, setChecking] = useState(false)
   const [uploading, setUploading] = useState(false)
 
+  // Quick Rate state
+  const [albums, setAlbums] = useState<Album[]>([])
+  const [currentAlbumIndex, setCurrentAlbumIndex] = useState(0)
+  const [rating, setRating] = useState(5)
+  const [ratedCount, setRatedCount] = useState(0)
+  const [skippedCount, setSkippedCount] = useState(0)
+  const [submitting, setSubmitting] = useState(false)
+  const [loadingAlbums, setLoadingAlbums] = useState(false)
+
   useEffect(() => {
     if (status === "unauthenticated") {
       router.push("/login")
@@ -27,6 +52,28 @@ export default function OnboardingPage() {
     }
   }, [session, status, router])
 
+  // Fetch albums when reaching step 4
+  useEffect(() => {
+    if (step === 4 && albums.length === 0) {
+      fetchAlbums()
+    }
+  }, [step])
+
+  const fetchAlbums = async () => {
+    setLoadingAlbums(true)
+    try {
+      // For onboarding, get popular/well-reviewed albums for broader appeal
+      const res = await fetch('/api/albums/swipe?limit=30&onboarding=true')
+      const data = await res.json()
+      if (data.success) {
+        setAlbums(data.data || [])
+      }
+    } catch (err) {
+      console.error('Failed to fetch albums:', err)
+    }
+    setLoadingAlbums(false)
+  }
+
   const checkUsername = async (value: string) => {
     if (value.length < 3) return
     setChecking(true)
@@ -111,37 +158,177 @@ export default function OnboardingPage() {
     setLoading(false)
   }
 
+  const handlePhotoComplete = async () => {
+    if (image) {
+      // Save the image to user profile
+      try {
+        await fetch("/api/users", {
+          method: "PATCH",
+          headers: { "Content-Type": "application/json" },
+          body: JSON.stringify({ image }),
+        })
+        await update()
+      } catch {
+        // Continue anyway
+      }
+    }
+    setStep(3)
+  }
+
+  const handleCountrySubmit = async () => {
+    if (!country) {
+      setError("Please select your country")
+      return
+    }
+
+    setLoading(true)
+    setError("")
+
+    try {
+      const res = await fetch("/api/users", {
+        method: "PATCH",
+        headers: { "Content-Type": "application/json" },
+        body: JSON.stringify({ country }),
+      })
+
+      if (!res.ok) {
+        setError("Failed to save country")
+        setLoading(false)
+        return
+      }
+
+      await update()
+      setStep(4)
+    } catch {
+      setError("Something went wrong")
+    }
+    setLoading(false)
+  }
+
+  const submitRating = async () => {
+    if (currentAlbumIndex >= albums.length) return
+
+    const album = albums[currentAlbumIndex]
+    setSubmitting(true)
+    setError("")
+
+    try {
+      const res = await fetch('/api/reviews', {
+        method: 'POST',
+        headers: { 'Content-Type': 'application/json' },
+        body: JSON.stringify({
+          albumId: album.id,
+          rating,
+          text: '',
+          isQuickRate: true,
+        }),
+      })
+      const data = await res.json()
+
+      if (data.success) {
+        setRatedCount((prev) => prev + 1)
+        nextAlbum()
+      } else {
+        // If album already rated, just skip to next
+        if (data.error?.includes('already reviewed')) {
+          nextAlbum()
+        } else {
+          setError(data.error || 'Failed to submit rating')
+        }
+      }
+    } catch (err) {
+      console.error('Failed to submit rating:', err)
+      setError('Failed to submit rating')
+    } finally {
+      setSubmitting(false)
+    }
+  }
+
+  const skip = () => {
+    setSkippedCount((prev) => prev + 1)
+    nextAlbum()
+  }
+
+  const nextAlbum = () => {
+    setRating(5)
+    setError("")
+    setCurrentAlbumIndex((prev) => prev + 1)
+  }
+
+  const handleKeyDown = useCallback(
+    (e: KeyboardEvent) => {
+      if (step !== 4 || submitting) return
+      if (e.key === 'Enter') {
+        e.preventDefault()
+        submitRating()
+      }
+      if (e.key === 's' || e.key === 'S') {
+        skip()
+      }
+    },
+    [step, submitRating, skip, submitting]
+  )
+
+  useEffect(() => {
+    window.addEventListener('keydown', handleKeyDown)
+    return () => window.removeEventListener('keydown', handleKeyDown)
+  }, [handleKeyDown])
+
   const handleComplete = async () => {
-    await update()
-    // Redirect to TasteID setup - hook them with their first reviews
-    router.push("/taste-setup")
+    setLoading(true)
+    try {
+      // Trigger TasteID computation with the new ratings
+      await fetch('/api/tasteid/compute', { method: 'POST' })
+    } catch {
+      // Continue anyway
+    }
+    setLoading(false)
+    router.push("/")
   }
 
+  const filteredCountries = countrySearch
+    ? COUNTRIES.filter(c =>
+        c.name.toLowerCase().includes(countrySearch.toLowerCase()) ||
+        c.code.toLowerCase().includes(countrySearch.toLowerCase())
+      )
+    : COUNTRIES
+
   if (status === "loading") {
     return (
       <div className="min-h-[80vh] flex items-center justify-center">
-        <p className="text-[#888]">Loading...</p>
+        <div className="flex flex-col items-center gap-3">
+          <div className="w-10 h-10 border-2 border-[#333] border-t-[#ffd700] animate-spin" />
+          <span className="text-xs tracking-[0.2em] uppercase text-[#888]">Loading</span>
+        </div>
       </div>
     )
   }
 
+  const currentAlbum = albums[currentAlbumIndex]
+  const isRatingComplete = ratedCount >= REQUIRED_RATINGS || currentAlbumIndex >= albums.length
+
   return (
-    <div className="min-h-[80vh] flex items-center justify-center px-4">
-      <div className="max-w-md w-full">
+    <div className="min-h-screen" style={{ backgroundColor: 'var(--background)', color: 'var(--foreground)' }}>
+      <div className="max-w-lg mx-auto px-4 py-8">
         {/* Progress indicator */}
         <div className="flex gap-2 mb-8">
-          <div className={`h-1 flex-1 ${step >= 1 ? "bg-white" : "bg-[#333]"}`} />
-          <div className={`h-1 flex-1 ${step >= 2 ? "bg-white" : "bg-[#333]"}`} />
+          {[1, 2, 3, 4].map((s) => (
+            <div
+              key={s}
+              className={`h-1 flex-1 transition-colors ${step >= s ? "bg-[#ffd700]" : "bg-[#333]"}`}
+            />
+          ))}
         </div>
 
+        {/* Step 1: Username */}
         {step === 1 && (
           <>
             <p className="text-[10px] tracking-[0.3em] uppercase text-[#ffd700] mb-4">
-              Step 1 of 2
+              Step 1 of {TOTAL_STEPS}
             </p>
             <h1 className="text-4xl font-bold tracking-tighter mb-4">Claim Your Identity</h1>
             <p className="text-[#888] mb-8">
-              Your username is your handle for earning badges and climbing the leaderboard. 
+              Your username is your handle for earning badges and climbing the leaderboard.
               Choose wiselyâ€”this is how people will remember you.
             </p>
 
@@ -190,14 +377,15 @@ export default function OnboardingPage() {
           </>
         )}
 
+        {/* Step 2: Photo */}
         {step === 2 && (
           <>
             <p className="text-[10px] tracking-[0.3em] uppercase text-[#ffd700] mb-4">
-              Step 2 of 2
+              Step 2 of {TOTAL_STEPS}
             </p>
             <h1 className="text-4xl font-bold tracking-tighter mb-4">Show Your Face</h1>
             <p className="text-[#888] mb-8">
-              When you earn badges and climb the leaderboard, people will see this. 
+              When you earn badges and climb the leaderboard, people will see this.
               Make it memorable.
             </p>
 
@@ -215,7 +403,6 @@ export default function OnboardingPage() {
                 ) : (
                   <DefaultAvatar size="lg" className="w-full h-full" />
                 )}
-                {/* Hover overlay with plus icon */}
                 <div className="absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center">
                   <svg
                     className="w-10 h-10 text-white"
@@ -254,21 +441,235 @@ export default function OnboardingPage() {
 
             <div className="flex gap-3">
               <button
-                onClick={handleComplete}
+                onClick={handlePhotoComplete}
                 className="flex-1 border border-[#333] py-4 px-6 font-bold text-lg hover:bg-[#111] transition-colors"
               >
                 Skip for now
               </button>
               <button
-                onClick={handleComplete}
+                onClick={handlePhotoComplete}
                 disabled={!image}
                 className="flex-1 bg-white text-black py-4 px-6 font-bold text-lg hover:bg-gray-100 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
               >
-                {image ? "Let's go!" : "Add a photo"}
+                {image ? "Continue" : "Add a photo"}
               </button>
             </div>
           </>
         )}
+
+        {/* Step 3: Country */}
+        {step === 3 && (
+          <>
+            <p className="text-[10px] tracking-[0.3em] uppercase text-[#ffd700] mb-4">
+              Step 3 of {TOTAL_STEPS}
+            </p>
+            <h1 className="text-4xl font-bold tracking-tighter mb-4">Where You At?</h1>
+            <p className="text-[#888] mb-8">
+              This helps us personalize your music recommendations.
+              We'll prioritize music from your region and similar markets.
+            </p>
+
+            <div className="space-y-4 mb-8">
+              <div>
+                <label className="block text-sm text-[#888] mb-2">Search countries</label>
+                <input
+                  type="text"
+                  value={countrySearch}
+                  onChange={(e) => setCountrySearch(e.target.value)}
+                  placeholder="Type to search..."
+                  className="w-full"
+                  autoFocus
+                />
+              </div>
+
+              <div className="h-64 overflow-y-auto border border-[#333]">
+                {filteredCountries.map((c) => (
+                  <button
+                    key={c.code}
+                    type="button"
+                    onClick={() => {
+                      setCountry(c.code)
+                      setError("")
+                    }}
+                    className={`w-full px-4 py-3 text-left flex items-center gap-3 transition-colors ${
+                      country === c.code
+                        ? 'bg-[#ffd700] text-black'
+                        : 'hover:bg-[#111]'
+                    }`}
+                  >
+                    <span className="text-xl">{c.flag}</span>
+                    <span>{c.name}</span>
+                    {country === c.code && (
+                      <svg className="w-5 h-5 ml-auto" fill="currentColor" viewBox="0 0 20 20">
+                        <path fillRule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clipRule="evenodd" />
+                      </svg>
+                    )}
+                  </button>
+                ))}
+              </div>
+
+              {error && (
+                <p className="text-sm text-red-500">{error}</p>
+              )}
+            </div>
+
+            <button
+              onClick={handleCountrySubmit}
+              disabled={loading || !country}
+              className="w-full bg-white text-black py-4 px-6 font-bold text-lg hover:bg-gray-100 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
+            >
+              {loading ? "Saving..." : "Continue"}
+            </button>
+          </>
+        )}
+
+        {/* Step 4: Quick Rate */}
+        {step === 4 && (
+          <>
+            <p className="text-[10px] tracking-[0.3em] uppercase text-[#ffd700] mb-4">
+              Step 4 of {TOTAL_STEPS}
+            </p>
+            <h1 className="text-4xl font-bold tracking-tighter mb-2">Train Your Taste</h1>
+            <p className="text-[#888] mb-6">
+              Rate {REQUIRED_RATINGS} albums so we can understand your music taste.
+              Skip anything you haven't heard.
+            </p>
+
+            {/* Progress bar */}
+            <div className="mb-6">
+              <div className="flex justify-between text-sm mb-2">
+                <span className="text-[#888]">{ratedCount} of {REQUIRED_RATINGS} rated</span>
+                {skippedCount > 0 && (
+                  <span className="text-[#666]">{skippedCount} skipped</span>
+                )}
+              </div>
+              <div className="w-full h-2 bg-[#333]">
+                <div
+                  className="h-full bg-[#ffd700] transition-all duration-300"
+                  style={{ width: `${(ratedCount / REQUIRED_RATINGS) * 100}%` }}
+                />
+              </div>
+            </div>
+
+            {loadingAlbums ? (
+              <div className="flex flex-col items-center justify-center py-20">
+                <div className="w-10 h-10 border-2 border-[#333] border-t-[#ffd700] animate-spin mb-4" />
+                <span className="text-xs tracking-[0.2em] uppercase text-[#888]">Loading albums</span>
+              </div>
+            ) : isRatingComplete ? (
+              <div className="text-center py-12">
+                <div className="w-20 h-20 mx-auto mb-6 flex items-center justify-center border-2 border-[#ffd700]">
+                  <span className="text-4xl">âœ“</span>
+                </div>
+                <h2 className="text-2xl font-bold mb-2">You're All Set!</h2>
+                <p className="text-[#888] mb-2">You rated</p>
+                <p className="text-5xl font-bold text-[#ffd700] mb-2 tabular-nums">{ratedCount}</p>
+                <p className="text-[#888] mb-8">albums</p>
+                <p className="text-sm text-[#666] mb-8">
+                  We're building your TasteID now. The more you rate, the better your recommendations.
+                </p>
+                <button
+                  onClick={handleComplete}
+                  disabled={loading}
+                  className="bg-[#ffd700] text-black px-8 py-4 font-bold text-lg hover:bg-[#ffed4a] transition-colors disabled:opacity-50"
+                >
+                  {loading ? "Computing TasteID..." : "Enter Waxfeed"}
+                </button>
+              </div>
+            ) : currentAlbum ? (
+              <div className="space-y-6">
+                {/* Album Card */}
+                <div className="border border-[#333]">
+                  <div className="aspect-square relative overflow-hidden">
+                    {currentAlbum.coverArtUrlLarge || currentAlbum.coverArtUrl ? (
+                      <img
+                        src={currentAlbum.coverArtUrlLarge || currentAlbum.coverArtUrl!}
+                        alt={currentAlbum.title}
+                        className="w-full h-full object-cover"
+                      />
+                    ) : (
+                      <div className="w-full h-full bg-[#111] flex items-center justify-center">
+                        <svg className="w-20 h-20 text-[#333]" fill="none" viewBox="0 0 24 24" stroke="currentColor">
+                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1} d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3" />
+                        </svg>
+                      </div>
+                    )}
+                  </div>
+                  <div className="p-4">
+                    <h2 className="text-xl font-bold mb-1 truncate">{currentAlbum.title}</h2>
+                    <p className="text-[#888] truncate">{currentAlbum.artistName}</p>
+                    {currentAlbum.genres && currentAlbum.genres.length > 0 && (
+                      <div className="flex flex-wrap gap-2 mt-3">
+                        {currentAlbum.genres.slice(0, 3).map((genre) => (
+                          <span
+                            key={genre}
+                            className="text-[10px] px-2 py-1 border border-[#333] text-[#666] uppercase tracking-wider"
+                          >
+                            {genre}
+                          </span>
+                        ))}
+                      </div>
+                    )}
+                  </div>
+                </div>
+
+                {/* Rating */}
+                <div className="space-y-4">
+                  <RatingSlider value={rating} onChange={setRating} disabled={submitting} />
+
+                  {error && (
+                    <p className="text-red-500 text-sm text-center">{error}</p>
+                  )}
+
+                  <div className="flex gap-3">
+                    <button
+                      onClick={skip}
+                      disabled={submitting}
+                      className="flex-1 py-4 border border-[#333] text-[#888] font-bold uppercase tracking-wider hover:border-white hover:text-white transition-colors disabled:opacity-50"
+                    >
+                      Haven't Heard
+                    </button>
+                    <button
+                      onClick={submitRating}
+                      disabled={submitting}
+                      className="flex-1 py-4 bg-[#ffd700] text-black font-bold uppercase tracking-wider hover:bg-[#ffed4a] transition-colors disabled:opacity-50"
+                    >
+                      {submitting ? 'Saving...' : 'Rate'}
+                    </button>
+                  </div>
+
+                  <p className="text-center text-xs text-[#666]">
+                    <kbd className="px-1.5 py-0.5 border border-[#333] text-[10px]">Enter</kbd> to rate Â· <kbd className="px-1.5 py-0.5 border border-[#333] text-[10px]">S</kbd> to skip
+                  </p>
+                </div>
+              </div>
+            ) : (
+              <div className="text-center py-12">
+                <p className="text-[#888] mb-4">No more albums available.</p>
+                <button
+                  onClick={handleComplete}
+                  disabled={loading}
+                  className="bg-[#ffd700] text-black px-8 py-4 font-bold text-lg hover:bg-[#ffed4a] transition-colors disabled:opacity-50"
+                >
+                  {loading ? "Setting up..." : "Continue to Waxfeed"}
+                </button>
+              </div>
+            )}
+
+            {/* Skip to finish option */}
+            {!isRatingComplete && ratedCount >= 5 && (
+              <div className="mt-8 text-center">
+                <button
+                  onClick={handleComplete}
+                  disabled={loading}
+                  className="text-[#666] text-sm hover:text-white transition-colors"
+                >
+                  Skip and finish with {ratedCount} ratings â†’
+                </button>
+              </div>
+            )}
+          </>
+        )}
       </div>
     </div>
   )
diff --git a/src/data/countries.ts b/src/data/countries.ts
new file mode 100644
index 0000000..6b1d283
--- /dev/null
+++ b/src/data/countries.ts
@@ -0,0 +1,69 @@
+// ISO 3166-1 alpha-2 country codes with names
+export const COUNTRIES = [
+  { code: 'US', name: 'United States', flag: 'ðŸ‡ºðŸ‡¸' },
+  { code: 'GB', name: 'United Kingdom', flag: 'ðŸ‡¬ðŸ‡§' },
+  { code: 'CA', name: 'Canada', flag: 'ðŸ‡¨ðŸ‡¦' },
+  { code: 'AU', name: 'Australia', flag: 'ðŸ‡¦ðŸ‡º' },
+  { code: 'DE', name: 'Germany', flag: 'ðŸ‡©ðŸ‡ª' },
+  { code: 'FR', name: 'France', flag: 'ðŸ‡«ðŸ‡·' },
+  { code: 'ES', name: 'Spain', flag: 'ðŸ‡ªðŸ‡¸' },
+  { code: 'IT', name: 'Italy', flag: 'ðŸ‡®ðŸ‡¹' },
+  { code: 'JP', name: 'Japan', flag: 'ðŸ‡¯ðŸ‡µ' },
+  { code: 'KR', name: 'South Korea', flag: 'ðŸ‡°ðŸ‡·' },
+  { code: 'BR', name: 'Brazil', flag: 'ðŸ‡§ðŸ‡·' },
+  { code: 'MX', name: 'Mexico', flag: 'ðŸ‡²ðŸ‡½' },
+  { code: 'AR', name: 'Argentina', flag: 'ðŸ‡¦ðŸ‡·' },
+  { code: 'NL', name: 'Netherlands', flag: 'ðŸ‡³ðŸ‡±' },
+  { code: 'BE', name: 'Belgium', flag: 'ðŸ‡§ðŸ‡ª' },
+  { code: 'SE', name: 'Sweden', flag: 'ðŸ‡¸ðŸ‡ª' },
+  { code: 'NO', name: 'Norway', flag: 'ðŸ‡³ðŸ‡´' },
+  { code: 'DK', name: 'Denmark', flag: 'ðŸ‡©ðŸ‡°' },
+  { code: 'FI', name: 'Finland', flag: 'ðŸ‡«ðŸ‡®' },
+  { code: 'PL', name: 'Poland', flag: 'ðŸ‡µðŸ‡±' },
+  { code: 'AT', name: 'Austria', flag: 'ðŸ‡¦ðŸ‡¹' },
+  { code: 'CH', name: 'Switzerland', flag: 'ðŸ‡¨ðŸ‡­' },
+  { code: 'PT', name: 'Portugal', flag: 'ðŸ‡µðŸ‡¹' },
+  { code: 'IE', name: 'Ireland', flag: 'ðŸ‡®ðŸ‡ª' },
+  { code: 'NZ', name: 'New Zealand', flag: 'ðŸ‡³ðŸ‡¿' },
+  { code: 'ZA', name: 'South Africa', flag: 'ðŸ‡¿ðŸ‡¦' },
+  { code: 'IN', name: 'India', flag: 'ðŸ‡®ðŸ‡³' },
+  { code: 'PH', name: 'Philippines', flag: 'ðŸ‡µðŸ‡­' },
+  { code: 'SG', name: 'Singapore', flag: 'ðŸ‡¸ðŸ‡¬' },
+  { code: 'MY', name: 'Malaysia', flag: 'ðŸ‡²ðŸ‡¾' },
+  { code: 'ID', name: 'Indonesia', flag: 'ðŸ‡®ðŸ‡©' },
+  { code: 'TH', name: 'Thailand', flag: 'ðŸ‡¹ðŸ‡­' },
+  { code: 'VN', name: 'Vietnam', flag: 'ðŸ‡»ðŸ‡³' },
+  { code: 'TW', name: 'Taiwan', flag: 'ðŸ‡¹ðŸ‡¼' },
+  { code: 'HK', name: 'Hong Kong', flag: 'ðŸ‡­ðŸ‡°' },
+  { code: 'CN', name: 'China', flag: 'ðŸ‡¨ðŸ‡³' },
+  { code: 'RU', name: 'Russia', flag: 'ðŸ‡·ðŸ‡º' },
+  { code: 'UA', name: 'Ukraine', flag: 'ðŸ‡ºðŸ‡¦' },
+  { code: 'TR', name: 'Turkey', flag: 'ðŸ‡¹ðŸ‡·' },
+  { code: 'IL', name: 'Israel', flag: 'ðŸ‡®ðŸ‡±' },
+  { code: 'AE', name: 'United Arab Emirates', flag: 'ðŸ‡¦ðŸ‡ª' },
+  { code: 'SA', name: 'Saudi Arabia', flag: 'ðŸ‡¸ðŸ‡¦' },
+  { code: 'EG', name: 'Egypt', flag: 'ðŸ‡ªðŸ‡¬' },
+  { code: 'NG', name: 'Nigeria', flag: 'ðŸ‡³ðŸ‡¬' },
+  { code: 'KE', name: 'Kenya', flag: 'ðŸ‡°ðŸ‡ª' },
+  { code: 'GH', name: 'Ghana', flag: 'ðŸ‡¬ðŸ‡­' },
+  { code: 'CO', name: 'Colombia', flag: 'ðŸ‡¨ðŸ‡´' },
+  { code: 'CL', name: 'Chile', flag: 'ðŸ‡¨ðŸ‡±' },
+  { code: 'PE', name: 'Peru', flag: 'ðŸ‡µðŸ‡ª' },
+  { code: 'VE', name: 'Venezuela', flag: 'ðŸ‡»ðŸ‡ª' },
+  { code: 'CZ', name: 'Czech Republic', flag: 'ðŸ‡¨ðŸ‡¿' },
+  { code: 'RO', name: 'Romania', flag: 'ðŸ‡·ðŸ‡´' },
+  { code: 'HU', name: 'Hungary', flag: 'ðŸ‡­ðŸ‡º' },
+  { code: 'GR', name: 'Greece', flag: 'ðŸ‡¬ðŸ‡·' },
+  { code: 'PR', name: 'Puerto Rico', flag: 'ðŸ‡µðŸ‡·' },
+  { code: 'JM', name: 'Jamaica', flag: 'ðŸ‡¯ðŸ‡²' },
+] as const
+
+export type CountryCode = typeof COUNTRIES[number]['code']
+
+export function getCountryByCode(code: string) {
+  return COUNTRIES.find(c => c.code === code)
+}
+
+export function getCountryName(code: string) {
+  return getCountryByCode(code)?.name || code
+}
-- 
2.50.1 (Apple Git-155)

